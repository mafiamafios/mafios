<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mafios Search</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
  <div id="loader"></div>
  <h1>
    <span>M</span><span>A</span><span>F</span><span>I</span><span>O</span><span>S</span>
  </h1>
  <div class="search-box">
    <div class="autocomplete-box" id="autocompleteBox"></div>
<input type="text" id="searchInput" placeholder="Search Mafios world..." oninput="showSuggestions()" />

    <input type="text" id="searchInput" placeholder="Search Mafios world..." />
    <button onclick="search()">Search</button>
    <a href="dashboard.html">Go to Dashboard</a>
  </div>

  <div id="results"></div>

  <script>
    setTimeout(() => {
      document.getElementById("loader").style.display = "none";
    }, 2000);

    const supabaseClient = supabase.createClient(
      "https://gmexnhcawqfndbtsqauj.supabase.co",
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdtZXhuaGNhd3FmbmRidHNxYXVqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM0NDczODAsImV4cCI6MjA2OTAyMzM4MH0.3Qsx0-pLF8gGlXE5Bnf_mFGlcNuUOVYhWZdDsupD3TM"
    );

    function search() {
  const query = document.getElementById('searchInput').value.trim();
  if(!query) return alert("Type something to search!");
  window.location.href = "search.html?q=" + encodeURIComponent(query);
}


      // Save history in localStorage
      let history = JSON.parse(localStorage.getItem("mafios_history")) || [];
      history.unshift(query);
      localStorage.setItem("mafios_history", JSON.stringify(history.slice(0, 5)));

      // Display results (demo)
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = `<div class='result-item'>Result for: ${query}</div>` +
        history.map(h => `<div class='result-item'>History: ${h}</div>`).join('');
    }

    supabaseClient.auth.getUser().then(({ data }) => {
      if (!data.user) {
        console.log("Guest Mode: User not logged in");
      }
    });
  </script>
</body>
</html>
